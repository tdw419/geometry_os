---
spec: ascii-desktop-control
basePath: .auto-claude/specs/ascii-desktop-control
phase: implementation
task: 3/5
updated: 2026-02-21T21:35:00Z
---

# Progress: ascii-desktop-control

## Original Goal

Create unified AI-to-desktop control system allowing Claude Code and Gemini to control Linux desktop via ASCII representations with WordPress-based directive polling

## Completed Tasks

- [x] 1.1 - Research phase complete
- [x] 1.1 Add ImageMagick screenshot fallback to get_ascii_view.py
- [x] 2.1 Create Claude Code skill directory structure
- [x] 2.2 Clean up old instruction file
- [x] 3.1 Add intent parsing to directive daemon

## Current Task

Task 3.1 complete. Added heuristic intent parsing to `scripts/directive_daemon.py` with:
- `parse_directive_intent(directive: Dict) -> Dict` - Extracts action, target, text from directive
- `build_llm_prompt(ascii_view, bindings, directive) -> str` - Builds formatted prompt for LLM
- `parse_llm_response(response: str) -> Dict` - Extracts action array from LLM JSON output

Key features:
- Action keyword mapping for click/type/key/move/wait/focus/close
- Target extraction using regex patterns (window A, button B, etc.)
- Text extraction from quotes or after type/enter keywords
- Key sequence detection (Ctrl+C, Alt+Tab)
- Confidence scoring (0.0-1.0)

## Learnings

- Gemini skill already operational at `.gemini/skills/ascii-desktop-control/`
- WordPress API has all needed endpoints: `getDirectives`, `markDirectiveProcessed`, `postDirectiveResponse`
- X11 tools installed: `xdotool`, `xwininfo`, `convert` (ImageMagick)
- AT-SPI (`pyatspi`) NOT installed - but ImageMagick fallback covers black-box apps
- ASCII Scene Graph system exists at `systems/visual_shell/ascii_scene/` for declarative UI mapping
- Visual Bridge (WebSocket on 8768) can broadcast events to browser HUD
- Old `.claude_ascii_control` file removed as part of cleanup
- Screenshot-to-ASCII uses grayscale conversion with character mapping: " .:-=+*#%@"
- Intent parsing uses ACTION_KEYWORDS dict with synonym mapping for robustness
- parse_llm_response handles multiple JSON formats: raw arrays, code blocks with/without json label

## Blockers

- None currently

## Next

Task 3.2: Add LLM integration to directive daemon
