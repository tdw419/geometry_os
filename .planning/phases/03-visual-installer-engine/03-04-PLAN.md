---
phase: 03-visual-installer-engine
plan: 04
type: execute
wave: 4
depends_on: ["03-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can install an OS to disk with single command"
    - "Installation progress displays visually"
    - "Installation verifies container before write"
    - "Installation can be cancelled safely"
  artifacts: []
  key_links: []
---

<objective>
Human verification of the complete Visual Installer Engine flow using a real .rts.png container.

Purpose: Confirm the end-to-end installation works as expected from user perspective: single command, visual progress, verification, and safe cancellation.
Output: Verification confirmation and any issues found
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Visual Installer Engine with:
- InstallEngine class orchestrating verification, write, and cleanup
- DiskWriter with chunked writes and progress callbacks
- InstallProgress with install-specific stages
- CLI subcommand `pixelrts install file.png target`
- Unit tests covering verification, write, cancellation, cleanup
</what-built>
  <how-to-verify>
1. Run the test suite to confirm all tests pass:
   ```
   pytest systems/pixel_compiler/tests/test_install_engine.py -v
   ```

2. Test the install command with a real .rts.png container:
   ```
   pixelrts install alpine.rts.png test_output.img --verbose
   ```

3. Verify the output shows:
   - VERIFYING stage with hash verification
   - PREPARING stage with disk space check
   - WRITING stage with progress percentage
   - SYNCING stage with fsync
   - COMPLETED stage with bytes written

4. Test cancellation (Ctrl+C during write):
   ```
   # Use a larger file to have time to cancel
   pixelrts install large.rts.png test_cancel.img
   # Press Ctrl+C during WRITING stage
   ```
   - Verify temp file is cleaned up
   - Verify command exits cleanly with message about cancellation

5. Test verification failure:
   ```
   # Corrupt a container (change one byte)
   # pixelrts install corrupted.png test.img should fail with hash mismatch
   ```

Type "approved" if all verification steps pass, or describe any issues found.
</how-to-verify>
  <resume-signal>Type "approved" or describe issues found</resume-signal>
</task>

</tasks>

<verification>
Manual verification of:
- [ ] pytest passes all tests
- [ ] `pixelrts install file.png target` shows progress through all stages
- [ ] Hash verification prevents corrupted installs
- [ ] Ctrl+C cancellation cleans up temp files
</verification>

<success_criteria>
- User can install OS from .rts.png with single `pixelrts install` command
- Progress displays visually with percentage and current operation
- Verification runs before any disk write
- Cancellation is safe with partial cleanup
</success_criteria>

<output>
After completion, create `.planning/phases/03-visual-installer-engine/03-04-SUMMARY.md`
</output>
