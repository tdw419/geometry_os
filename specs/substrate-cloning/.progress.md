---
spec: substrate-cloning
basePath: specs/substrate-cloning
phase: tasks
task: 3/7
updated: 2026-02-19
---

# Progress: substrate-cloning

## Original Goal

Convert extracted UI structures into native PixelRTS geometric entities that run without VMs.

## Reference Documents

- Implementation Plan v2: `docs/plans/2026-02-19-substrate-cloning-implementation-v2.md`
- Team Definition: `apps/openspec/openspec/teams/substrate-cloning-team.yaml`

## Completed Tasks

1. ✅ Research phase - discovered existing UITransmuter
2. ✅ Planning phase - 7 tasks, 14 tests defined
3. ✅ Task 1: UITransmuter Wrapper - Created wrapper importing from conductor track (2 tests)
4. ✅ Task 2: SubstrateBrush - Binary painting with Hilbert curve indexing (5 tests)
5. ✅ Task 3: CloneOrchestrator - Pipeline orchestration for UI cloning (5 tests)

## Current Task

Task 4: Add clone_tile RPC to LiveTileService

## Plan Summary

| Task | Component | Tests | Status |
|------|-----------|-------|--------|
| 1 | UITransmuter Wrapper | 2 | ✅ Done |
| 2 | SubstrateBrush | 5 | ✅ Done |
| 3 | CloneOrchestrator | 5 | ✅ Done |
| 4 | LiveTileService RPC | 1 | Pending |
| 5 | Frontend Clone Button | - | Pending |
| 6 | E2E Integration | 2 | Pending |
| 7 | Documentation | - | Pending |

## Learnings

- ExtractionBridge already operational (verified)
- PixelRTS v2 encoder available at `systems/pixel_compiler/pixelrts_v2_core.py`
- WGSL template exists at `conductor/tracks/shotcut-on-the-map/timeline_template.wgsl.j2`
- **UITransmuter already exists** at `conductor/tracks/shotcut-on-the-map/ui_transmuter.py` (307 lines)
- UITransmuter implements SDF functions: sdBox, sdRoundedBox, sdLine
- Jinja2 v3.1.6 installed; numpy v1.26.4 installed; PIL available
- HilbertCurve class in pixelrts_v2_core.py provides d2xy/xy2d methods
- LiveTileService.handle_rpc() needs `clone_tile` method added
- AgentController needs Clone button in `.live-controls` div
- Test pattern: pytest with pytest-asyncio, fixtures in `systems/evolution_daemon/tests/`
- **Task 2 complete**: SubstrateBrush provides base painting (paint_pixel, paint_rect)
- HilbertBrush extends SubstrateBrush with curve-indexed painting (d2xy, xy2d, paint_at_hilbert)
- Both use HilbertCurve from pixelrts_v2_core for Hilbert coordinate conversion
- **Task 3 complete**: CloneOrchestrator provides pipeline orchestration
- CloneTask dataclass tracks task_id, source_tile_id, extraction_result, target_name, status
- CloneOrchestrator methods: request_clone, _execute_clone, get_generated_wgsl, get_task, list_tasks
- Outputs WGSL to `.geometry/clones/` directory

## Blockers

- None currently

## Next

Task 4: Add clone_tile RPC to LiveTileService
