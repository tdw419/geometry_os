---
spec: terminal-clone-pixelrts
basePath: specs/terminal-clone-pixelrts
phase: implementation
task: 4/6
updated: 2026-02-20T19:30:00Z
---

# Progress: terminal-clone-pixelrts

## Original Goal

Build a hybrid system that rips terminals from VMs and renders them as PixelRTS tiles with native PTY support for local shells. Architecture: PTY engine (Rust/nix::pty) -> TerminalEmulator (VT100/ANSI) -> TerminalBuffer (cells) -> GPU shader (WGSL) -> VAT placement (Python). Auto-detect monitors VM framebuffers for terminal windows.

## Completed Tasks

- [x] **Task 4: VAT Bridge (Python)** - Phase 3 Integration
  - Created `systems/visual_shell/api/terminal_vat_bridge.py`
  - 19 tests passing (offline mode)
  - Integrates with VATManager for focal-point placement
  - HTTP API client for Rust API server
  - Terminal lifecycle: spawn, move, resize, destroy

- [x] **Task 4: API Server Endpoints** - Rust side
  - Added terminal state to RuntimeState
  - `/api/terminal/spawn` - Queue terminal creation
  - `/api/terminal/{id}/resize` - Resize terminal
  - `/api/terminal/{id}` DELETE - Destroy terminal

## Current Task

Task 5: VM Terminal Detector - awaiting implementation

## Learnings

- **TerminalEmulator is production-ready** (1324 lines) with VT100/ANSI parsing, TerminalBuffer with scrollback, resize+reflow
- **FONT_8X16 bitmap atlas exists** - 8x16 pixel font for ASCII 32-127 (95 chars)
- **VATManager supports focal-point placement** - center at (2048, 2048) with random offset
- **TectonicIpc pattern for Python-Rust** - file-based JSON exchange, proven in Phase 28
- **nix crate needs term/pty features** - currently only has ioctl/fs/process
- **text_buffer.wgsl shows shader pattern** - storage buffer for cells, compute dispatch
- **ExtractionPipeline ready for VM detection** - OCR + clustering + widget detection
- **Feature gate "hypervisor" already exists** - TerminalEmulator uses it
- **UTF-8 limited to ASCII** - FONT_8X16 only has ASCII 32-127; Unicode would need MSDF
- **Texture upload is negligible** - 120x36 cells = ~69KB per terminal
- **API server uses axum** - Port 4445, RuntimeState for pending actions

## Blockers

- None currently

## Next

1. Implement VM Terminal Detector (Task 5)
2. Add E2E Integration Tests (Task 6)
3. Build Rust PTY Engine (Task 1) - foundation
